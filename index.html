<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GeoVision LK | Support</title>

<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@400;600&family=Noto+Sans+Tamil:wght@400;600&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<style>
    :root {
        --primary: #0f172a;        /* Professional Dark Navy */
        --accent: #2563eb;         /* Trustworthy Blue */
        --gradient: linear-gradient(135deg, #0f172a, #1e293b);
        --glass-bg: rgba(255, 255, 255, 0.98);
        --shadow-lg: 0 20px 50px rgba(15, 23, 42, 0.3);
    }

    body {
        font-family: 'Outfit', 'Noto Sans Sinhala', 'Noto Sans Tamil', sans-serif;
        background: #f1f5f9; 
        margin: 0;
        height: 100vh;
        /* subtle grid pattern for professional look */
        background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
        background-size: 30px 30px;
        overflow: hidden;
    }

    /* --- Placeholder Content (Background) --- */
    .website-background {
        height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        color: #334155;
    }
    .website-background h1 { font-size: 4rem; margin: 0; color: var(--primary); letter-spacing: -2px; }
    .website-background p { font-size: 1.5rem; color: #64748b; margin-top: 10px; }
    .website-background .note { margin-top: 40px; font-size: 0.9rem; color: var(--accent); font-weight: 600; animation: bounce 2s infinite; }
    @keyframes bounce { 0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 40% {transform: translateY(-10px);} 60% {transform: translateY(-5px);} }

    /* --- Floating Button --- */
    .chat-toggle-btn {
        position: fixed; bottom: 30px; right: 30px;
        width: 65px; height: 65px;
        background: var(--accent);
        border-radius: 50%; color: white; border: none; cursor: pointer;
        box-shadow: 0 10px 25px rgba(37, 99, 235, 0.5); z-index: 1000;
        display: flex; align-items: center; justify-content: center; font-size: 28px;
        transition: all 0.3s; 
    }
    .chat-toggle-btn:hover { transform: scale(1.1) rotate(10deg); background: var(--primary); }
    .chat-toggle-btn.open { transform: rotate(180deg); background: #334155; }

    /* --- Chat Window --- */
    .chat-widget {
        position: fixed; bottom: 110px; right: 30px;
        width: 380px; height: 600px;
        background: var(--glass-bg); 
        border: 1px solid rgba(255, 255, 255, 0.5); border-radius: 20px;
        box-shadow: var(--shadow-lg);
        display: flex; flex-direction: column; overflow: hidden; z-index: 999;
        opacity: 0; transform: scale(0.9) translate(20px, 20px); pointer-events: none;
        transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .chat-widget.active { opacity: 1; transform: scale(1) translate(0, 0); pointer-events: all; }

    /* Header */
    .header {
        background: var(--primary); padding: 20px;
        display: flex; align-items: center; justify-content: space-between; color: white;
    }
    .header-info h2 { margin: 0; font-size: 18px; font-weight: 600; }
    .header-info span { font-size: 12px; opacity: 0.8; display: flex; align-items: center; gap: 5px; }
    .status-dot { width: 8px; height: 8px; background: #22c55e; border-radius: 50%; }

    .header-actions { display: flex; gap: 10px; }
    .lang-btn { background: rgba(255,255,255,0.2); border: none; color: white; padding: 4px 8px; border-radius: 6px; cursor: pointer; font-size: 11px; font-weight: bold; }
    .lang-btn:hover, .lang-btn.active { background: white; color: var(--primary); }

    /* Messages */
    #chat-history {
        flex: 1; padding: 20px; overflow-y: auto;
        display: flex; flex-direction: column; gap: 15px; scroll-behavior: smooth;
        background: #f8fafc;
    }
    .message { max-width: 85%; padding: 14px 18px; border-radius: 16px; font-size: 0.95rem; line-height: 1.5; animation: slideUp 0.3s ease; }
    @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    .bot-message { background: white; color: #1e293b; border-bottom-left-radius: 4px; border: 1px solid #e2e8f0; box-shadow: 0 2px 5px rgba(0,0,0,0.02); }
    .user-message { background: var(--accent); color: white; border-bottom-right-radius: 4px; margin-left: auto; }
    .bot-message strong { color: var(--accent); }
    .bot-message a { color: var(--accent); text-decoration: underline; font-weight: 600; }

    /* Quick Actions (Chips) */
    .suggestions { display: flex; gap: 8px; padding: 12px 15px; background: white; border-top: 1px solid #f1f5f9; overflow-x: auto; scrollbar-width: none; }
    .chip {
        white-space: nowrap; background: #f1f5f9; border: 1px solid #e2e8f0; padding: 8px 14px; border-radius: 20px;
        font-size: 12px; color: #475569; cursor: pointer; transition: 0.2s; font-weight: 500;
    }
    .chip:hover { background: var(--primary); color: white; border-color: var(--primary); }

    /* Input */
    .input-area { padding: 15px; background: white; display: flex; gap: 10px; align-items: center; border-top: 1px solid #f1f5f9; }
    input {
        flex: 1; padding: 12px 16px; border-radius: 30px; border: 1px solid #cbd5e1;
        outline: none; font-size: 14px; transition: 0.2s; background: #f8fafc;
    }
    input:focus { border-color: var(--accent); background: white; box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }
    #send-btn {
        background: var(--primary); color: white; border: none; width: 45px; height: 45px; border-radius: 50%;
        cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.2s;
    }
    #send-btn:hover { background: var(--accent); transform: scale(1.05); }

    /* Typing Indicator */
    .typing-indicator { display: none; padding: 0 20px 15px; font-size: 12px; color: #94a3b8; font-style: italic; }

    @media (max-width: 480px) {
        .chat-widget { width: 92%; right: 4%; bottom: 100px; height: 65vh; }
    }
</style>
</head>
<body>

    <!-- Background (Your Website) -->
    <div class="website-background">
        <h1>GeoVision LK</h1>
        <p>Interactive Data Intelligence</p>
        <div class="note">Click the chat icon below ðŸ‘‡</div>
    </div>

    <!-- Chat Button -->
    <button class="chat-toggle-btn" id="toggle-btn" onclick="toggleChat()">
        <i class="fa-solid fa-comment-alt"></i>
    </button>

    <!-- Chat Widget -->
    <div class="chat-widget" id="chat-widget">
        <!-- Header -->
        <div class="header">
            <div class="header-info">
                <h2>GeoVision Support</h2>
                <span><div class="status-dot"></div> Online Now</span>
            </div>
            <div class="header-actions">
                <button class="lang-btn active" onclick="setLang('en', this)">EN</button>
                <button class="lang-btn" onclick="setLang('si', this)">SI</button>
                <button class="lang-btn" onclick="setLang('ta', this)">TA</button>
            </div>
        </div>

        <!-- Chat Area -->
        <div id="chat-history"></div>
        <div class="typing-indicator" id="typing-ind">Agent is typing...</div>

        <!-- Suggestions -->
        <div class="suggestions" id="suggestions"></div>

        <!-- Input -->
        <div class="input-area">
            <input id="user-input" type="text" placeholder="Type your question..." />
            <button id="send-btn"><i class="fa-solid fa-paper-plane"></i></button>
        </div>
    </div>

<script>
// ==========================================
// 1. API CONFIGURATION
// ==========================================
const API_KEY = "AIzaSyCvgGdCXD7K9C7LSGuK7oAxy04fKSHq4Og"; 

// ==========================================
// 2. KNOWLEDGE BASE (Customer Facing Only)
// ==========================================
// I have removed all risks, weaknesses, and internal timeline issues.
const BASE_KNOWLEDGE = `
You are the Official Sales & Support AI for "GeoVision LK".
Your Goal: Impress customers, explain features, and provide contact info.
Tone: Professional, Enthusiastic, Helpful.

--- PRODUCT OVERVIEW ---
**Product Name:** GeoVision LK Dashboard.
**What is it?** A cutting-edge web platform that turns boring spreadsheets into an Interactive 3D Map.
**Who is it for?** Managers, Donors, and Operational Teams who need instant data visibility.

--- KEY SELLING POINTS (Benefits) ---
1. **Instant Visual Insights:** See exactly where your team is working on a 3D map. No more reading 50-page reports.
2. **Real-Time KPIs:** Track "Total Reach", "Seminars Conducted", and "Active Districts" instantly.
3. **District Deep-Dive:** Click on any district to see specific charts, contact details, and photos.
4. **Mobile Ready:** Works perfectly on phones and tablets.

--- CONTACT INFORMATION ---
If a user asks for pricing, a demo, or how to buy:
"To schedule a personalized demo or discuss pricing, please contact our Project Owner:"
**Phone:** +94 77 123 4567
**Email:** sales@geovision.lk

--- RULES ---
- Never mention "risks", "bugs", or "delays".
- If asked about a missing feature, say "That is a great idea we are exploring for future updates!"
- Keep answers short and easy to read.
`;

// ==========================================
// 3. UI LOGIC
// ==========================================
const widget = document.getElementById('chat-widget');
const toggleBtn = document.getElementById('toggle-btn');
const chatHistory = document.getElementById('chat-history');
const userInput = document.getElementById('user-input');
const sendBtn = document.getElementById('send-btn');
const typingInd = document.getElementById('typing-ind');
const suggestionsDiv = document.getElementById('suggestions');

let currentLang = 'en';
let isOpen = false;

const translations = {
    en: {
        welcome: "Hello! ðŸ‘‹ Welcome to GeoVision LK. I can show you how our 3D Dashboard can transform your operations. How can I help?",
        placeholder: "Ask about features, pricing...",
        chips: ["What is GeoVision?", "Key Features", "Contact Sales", "Request Demo"]
    },
    si: {
        welcome: "à¶†à¶ºà·”à¶¶à·à·€à¶±à·Š! ðŸ‘‹ GeoVision LK à·€à·™à¶­ à·ƒà·à¶¯à¶»à¶ºà·™à¶±à·Š à¶´à·’à·…à·’à¶œà¶±à·’à¶¸à·”. à¶…à¶´à¶œà·š 3D Dashboard à¶¸à¶œà·’à¶±à·Š à¶”à¶¶à·š à¶¯à¶­à·Šà¶­ à¶šà·…à¶¸à¶±à·à¶šà¶»à¶«à¶º à¶´à·„à·ƒà·” à¶šà¶»à¶± à¶†à¶šà·à¶»à¶º à¶¸à¶§ à¶´à·à·„à·à¶¯à·’à¶½à·’ à¶šà·… à·„à·à¶š.",
        placeholder: "à¶¸à·’à¶½ à¶œà¶«à¶±à·Š à·„à· à¶´à·„à·ƒà·”à¶šà¶¸à·Š à¶œà·à¶± à¶…à·ƒà¶±à·Šà¶±...",
        chips: ["GeoVision à¶ºà¶±à·” à¶šà·”à¶¸à¶šà·Šà¶¯?", "à¶´à·Šâ€à¶»à¶°à·à¶± à¶´à·„à·ƒà·”à¶šà¶¸à·Š", "à¶…à¶´à·€ à¶…à¶¸à¶­à¶±à·Šà¶±", "Demo à¶‘à¶šà¶šà·Š à¶…à·€à·à·Šâ€à¶ºà¶ºà·’"]
    },
    ta: {
        welcome: "à®µà®£à®•à¯à®•à®®à¯! ðŸ‘‹ GeoVision LK à®•à¯à®•à¯ à®µà®°à®µà¯‡à®±à¯à®•à®¿à®±à¯‹à®®à¯. à®Žà®™à¯à®•à®³à¯ 3D Dashboard à®‰à®™à¯à®•à®³à¯ à®¤à®°à®µà¯ à®…à®±à®¿à®•à¯à®•à¯ˆà®¯à¯ˆ à®Žà®µà¯à®µà®¾à®±à¯ à®®à®¾à®±à¯à®±à¯à®•à®¿à®±à®¤à¯ à®Žà®©à¯à®ªà®¤à¯ˆ à®¨à®¾à®©à¯ à®µà®¿à®³à®•à¯à®•à¯à®•à®¿à®±à¯‡à®©à¯.",
        placeholder: "à®…à®®à¯à®šà®™à¯à®•à®³à¯ à®ªà®±à¯à®±à®¿ à®•à¯‡à®Ÿà¯à®•à®µà¯à®®à¯...",
        chips: ["GeoVision à®Žà®©à¯à®±à®¾à®²à¯ à®Žà®©à¯à®©?", "à®®à¯à®•à¯à®•à®¿à®¯ à®…à®®à¯à®šà®™à¯à®•à®³à¯", "à®¤à¯Šà®Ÿà®°à¯à®ªà¯à®•à¯à®•à¯", "Demo à®µà¯‡à®£à¯à®Ÿà¯à®®à¯"]
    }
};

function renderUI() {
    // Set Chips
    suggestionsDiv.innerHTML = '';
    translations[currentLang].chips.forEach(text => {
        const btn = document.createElement('button');
        btn.className = 'chip';
        btn.innerText = text;
        btn.onclick = () => { userInput.value = text; sendMessage(); };
        suggestionsDiv.appendChild(btn);
    });
    
    // Set Placeholder
    userInput.placeholder = translations[currentLang].placeholder;

    // Reset Chat if empty
    if(chatHistory.children.length === 0) {
        appendMessage(translations[currentLang].welcome, false);
    }
}

function setLang(lang, btn) {
    currentLang = lang;
    document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    chatHistory.innerHTML = ''; // Clear chat on lang switch
    renderUI();
}

function toggleChat() {
    isOpen = !isOpen;
    if (isOpen) {
        widget.classList.add('active');
        toggleBtn.classList.add('open');
        toggleBtn.innerHTML = '<i class="fa-solid fa-xmark"></i>';
        setTimeout(() => userInput.focus(), 300); // Auto focus input
    } else {
        widget.classList.remove('active');
        toggleBtn.classList.remove('open');
        toggleBtn.innerHTML = '<i class="fa-solid fa-comment-alt"></i>';
    }
}

function appendMessage(text, isUser) {
    const div = document.createElement('div');
    div.className = `message ${isUser ? 'user-message' : 'bot-message'}`;
    if (isUser) {
        div.innerText = text;
    } else {
        div.innerHTML = marked.parse(text); // Use Markdown for bot
    }
    chatHistory.appendChild(div);
    chatHistory.scrollTop = chatHistory.scrollHeight;
}

async function sendMessage() {
    const text = userInput.value.trim();
    if (!text) return;

    appendMessage(text, true);
    userInput.value = '';
    typingInd.style.display = 'block';

    // Language Instruction
    let langInstruction = "Reply in English.";
    if (currentLang === 'si') langInstruction = "Reply in Sinhala.";
    if (currentLang === 'ta') langInstruction = "Reply in Tamil.";

    const prompt = `${BASE_KNOWLEDGE}\n\nUser Question: ${text}\n\n${langInstruction}`;

    try {
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${API_KEY}`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                contents: [{ parts: [{ text: prompt }] }]
            })
        });

        const data = await response.json();
        typingInd.style.display = 'none';

        if (data.candidates) {
            appendMessage(data.candidates[0].content.parts[0].text, false);
        } else {
            appendMessage("I'm having trouble connecting. Please try again.", false);
        }

    } catch (error) {
        typingInd.style.display = 'none';
        appendMessage("Network Error. Please check your internet.", false);
    }
}

// Event Listeners
sendBtn.addEventListener('click', sendMessage);
userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendMessage(); });

// Initialize
renderUI();
</script>
</body>
</html>
